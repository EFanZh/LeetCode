pub mod brute_force_dfs;

pub trait Solution {
    fn maximal_path_quality(values: Vec<i32>, edges: Vec<Vec<i32>>, max_time: i32) -> i32;
}

#[cfg(test)]
mod tests {
    use super::Solution;

    type TestCase<'a> = ((&'a [i32], &'a [[i32; 3]], i32), i32);

    const EXTRA_TEST_CASE_1: TestCase = (
        (
            &[
                894_975, 534_665, 821_821, 735_356, 563_014, 551_042, 846_579, 330_137, 554_236, 390_856, 714_703,
                444_422, 852_480, 398_754, 757_664, 109_103, 418_565, 675_762, 379_180, 526_744, 500_526, 533_718,
                765_465, 462_520, 142_793, 844_172, 10461, 568_876, 621_551, 324_057, 291_875, 229_728, 952_798,
                581_560, 607_222, 426_207, 808_349, 134_132, 608_332, 331_698, 89646, 703_507, 837_505, 62440, 177_196,
                864_032, 502_747, 452_351, 577_215, 233_488, 508_143, 450_116, 249_970, 635_340, 947_289, 766_622,
                908_764, 815_906, 956_378, 501_404, 438_222, 424_432, 394_672, 107_068, 165_226, 947_290, 625_921,
                244_375, 826_675, 657_099, 577_135, 728_928, 658_634, 792_379, 812_812, 738_175, 357_083, 965_082,
                749_501, 255_391, 978_528, 630_836, 824_886, 152_467, 500_712, 660_467, 730_809, 699_646, 282_237,
                579_847, 366_866, 575_275, 884_271, 554_473, 517_598, 992_082, 565_330, 98580, 154_832, 534_836,
                892_590, 977_549, 855_200, 5692, 112_827, 869_163, 385_858, 162_898, 708_765, 347_797, 376_344,
                719_455, 521_756, 28516, 363_417, 407_881, 912_781, 726_997, 814_664, 542_405, 154_157, 892_278,
                234_238, 111_485, 609_149, 422_346, 460_273, 304_067, 377_392, 773_008, 980_407, 562_459, 767_067,
                595_501, 593_693, 728_255, 995_618, 625_162, 306_350, 178_404, 974_069, 539_110, 628_036, 514_540,
                504_113, 163_456, 517_342, 763_188, 566_101, 172_089, 548_406, 695_765, 289_805, 681_308, 121_565,
                568_690, 790_012, 467_454, 612_475, 656_394, 995_368, 747_983, 587_045, 254_567, 491_593, 748_300,
                319_216, 985_530, 911_622, 422_042, 65826, 420_753, 325_908, 169_880, 37529, 504_300, 434_735, 519_840,
                441_838, 713_724, 615_496, 659_374, 819_554, 189_728, 407_570, 118_640, 381_101, 25449, 153_359,
                175_694, 123_564, 670_306, 913_813, 451_928, 859_095, 977_287, 337_664, 114_445, 661_525, 983_132,
                991_642, 118_284, 974_779, 285_613, 151_581, 549_808, 764_583, 808_976, 300_040, 619_932, 152_720,
                807_298, 178_559, 385_133, 651_363, 782_763, 730_092, 915_879, 208_779, 710_047, 320_057, 561_526,
                182_558, 422_548, 679_119, 548_245, 747_524, 392_482, 65207, 248_103, 560_915, 90174, 76085, 475_406,
                916_638, 188_797, 261_564, 43529, 76396, 513_051, 452_144, 662_143, 445_357, 84210, 141_552, 360_576,
                454_280, 878_266, 105_408, 404_802, 612_778, 843_418, 272_605, 902_385, 340_246, 155_069, 320_552,
                69465, 184_400, 283_787, 720_270, 410_570, 166_870, 323_852, 215_922, 859_701, 449_968, 93504, 753_197,
                991_915, 819_277, 699_561, 368_344, 603_263, 777_329, 822_696, 317_285, 992_315, 271_126, 315_399,
                534_791, 173_251,
            ],
            &[
                [0, 278, 83],
                [1, 137, 51],
                [2, 150, 62],
                [3, 24, 66],
                [4, 187, 29],
                [5, 159, 68],
                [6, 142, 77],
                [7, 190, 89],
                [8, 107, 37],
                [9, 10, 49],
                [11, 239, 81],
                [12, 192, 20],
                [13, 166, 89],
                [14, 150, 85],
                [15, 149, 29],
                [16, 253, 70],
                [17, 241, 20],
                [18, 189, 54],
                [19, 236, 88],
                [20, 152, 71],
                [21, 219, 29],
                [22, 274, 58],
                [23, 211, 43],
                [25, 247, 71],
                [26, 109, 40],
                [27, 69, 85],
                [28, 198, 78],
                [29, 102, 37],
                [30, 191, 55],
                [31, 132, 35],
                [32, 94, 14],
                [33, 272, 50],
                [34, 78, 83],
                [35, 259, 23],
                [36, 141, 86],
                [37, 39, 52],
                [38, 272, 79],
                [4, 40, 91],
                [41, 201, 11],
                [42, 265, 77],
                [43, 93, 48],
                [44, 256, 48],
                [2, 45, 33],
                [46, 265, 46],
                [47, 98, 24],
                [23, 48, 32],
                [49, 229, 24],
                [50, 139, 89],
                [2, 51, 92],
                [52, 221, 17],
                [53, 279, 86],
                [54, 118, 15],
                [55, 143, 20],
                [56, 65, 57],
                [57, 143, 77],
                [8, 58, 44],
                [59, 207, 24],
                [48, 60, 84],
                [61, 232, 81],
                [2, 62, 12],
                [63, 206, 94],
                [11, 64, 92],
                [33, 66, 62],
                [67, 74, 10],
                [68, 143, 38],
                [70, 267, 99],
                [47, 71, 44],
                [72, 125, 32],
                [26, 73, 38],
                [75, 201, 95],
                [17, 76, 68],
                [65, 77, 19],
                [79, 240, 46],
                [80, 139, 68],
                [81, 158, 12],
                [58, 82, 94],
                [83, 86, 29],
                [37, 84, 72],
                [85, 249, 40],
                [87, 158, 98],
                [36, 88, 71],
                [89, 280, 10],
                [90, 280, 68],
                [91, 217, 29],
                [92, 107, 18],
                [95, 280, 89],
                [50, 96, 98],
                [12, 97, 16],
                [99, 206, 50],
                [100, 162, 58],
                [101, 131, 62],
                [103, 149, 38],
                [104, 200, 53],
                [105, 241, 16],
                [106, 136, 88],
                [3, 108, 47],
                [14, 110, 94],
                [107, 111, 42],
                [51, 112, 88],
                [113, 120, 75],
                [114, 210, 76],
                [115, 253, 24],
                [116, 215, 20],
                [105, 117, 75],
                [119, 151, 49],
                [121, 166, 70],
                [15, 122, 46],
                [123, 281, 57],
                [124, 206, 57],
                [126, 131, 68],
                [127, 275, 64],
                [11, 128, 71],
                [129, 135, 10],
                [112, 130, 68],
                [133, 269, 66],
                [22, 134, 74],
                [99, 138, 20],
                [65, 140, 12],
                [144, 278, 95],
                [76, 145, 22],
                [146, 222, 71],
                [147, 265, 60],
                [148, 200, 59],
                [38, 153, 34],
                [19, 154, 37],
                [104, 155, 37],
                [156, 208, 78],
                [157, 244, 60],
                [160, 226, 62],
                [161, 255, 10],
                [19, 163, 41],
                [164, 196, 44],
                [165, 266, 93],
                [99, 167, 39],
                [53, 168, 67],
                [104, 169, 32],
                [170, 229, 61],
                [83, 171, 62],
                [164, 172, 86],
                [173, 234, 97],
                [159, 174, 72],
                [24, 175, 45],
                [113, 176, 69],
                [177, 238, 54],
                [178, 213, 23],
                [105, 179, 79],
                [180, 203, 24],
                [20, 181, 85],
                [144, 182, 88],
                [45, 183, 50],
                [184, 232, 42],
                [185, 214, 86],
                [93, 186, 75],
                [94, 188, 76],
                [79, 193, 24],
                [155, 194, 87],
                [195, 215, 32],
                [197, 246, 30],
                [150, 199, 45],
                [80, 202, 19],
                [164, 204, 11],
                [205, 214, 38],
                [209, 281, 91],
                [145, 212, 66],
                [159, 216, 19],
                [20, 218, 80],
                [16, 220, 67],
                [223, 280, 15],
                [224, 234, 93],
                [97, 225, 78],
                [5, 227, 25],
                [112, 228, 83],
                [171, 230, 24],
                [81, 231, 11],
                [233, 237, 12],
                [168, 235, 92],
                [242, 268, 16],
                [110, 243, 90],
                [90, 245, 16],
                [241, 248, 10],
                [43, 250, 53],
                [89, 251, 63],
                [17, 252, 32],
                [128, 254, 93],
                [172, 257, 65],
                [242, 258, 42],
                [52, 260, 77],
                [65, 261, 51],
                [107, 262, 82],
                [238, 263, 82],
                [227, 264, 11],
                [72, 270, 96],
                [210, 271, 68],
                [21, 273, 53],
                [178, 276, 45],
                [253, 277, 28],
                [16, 173, 68],
                [91, 130, 28],
                [149, 234, 30],
                [59, 189, 41],
                [75, 120, 75],
                [77, 175, 81],
                [116, 147, 19],
                [67, 115, 48],
                [162, 168, 98],
                [182, 234, 27],
                [44, 223, 48],
                [60, 178, 28],
                [88, 149, 51],
                [56, 170, 96],
                [38, 225, 46],
                [68, 277, 92],
                [203, 256, 81],
                [117, 209, 54],
                [92, 151, 48],
                [70, 125, 80],
                [33, 261, 50],
                [171, 208, 39],
                [140, 252, 64],
                [135, 215, 38],
                [66, 219, 96],
                [52, 86, 84],
                [54, 265, 48],
                [164, 194, 31],
                [185, 206, 12],
                [144, 157, 15],
                [117, 189, 91],
                [18, 104, 25],
                [17, 259, 87],
                [125, 189, 88],
                [144, 235, 52],
                [0, 141, 17],
                [208, 222, 94],
                [59, 148, 16],
                [270, 277, 95],
                [47, 172, 59],
                [185, 218, 21],
                [27, 250, 85],
                [54, 111, 69],
                [34, 179, 60],
                [9, 111, 70],
                [153, 218, 81],
                [128, 236, 90],
                [5, 199, 90],
                [84, 250, 44],
                [66, 216, 22],
                [95, 204, 90],
                [19, 35, 48],
                [134, 163, 23],
                [67, 157, 50],
                [53, 112, 48],
                [85, 262, 85],
                [126, 203, 28],
                [73, 242, 14],
                [26, 53, 15],
                [105, 170, 99],
                [174, 193, 47],
                [151, 240, 24],
                [137, 191, 76],
                [98, 261, 23],
                [48, 86, 51],
                [22, 103, 48],
                [208, 256, 17],
                [16, 133, 57],
                [143, 210, 74],
                [12, 221, 95],
                [56, 191, 45],
                [93, 269, 68],
                [89, 248, 56],
                [238, 269, 64],
                [132, 238, 15],
                [73, 236, 75],
                [54, 195, 74],
                [259, 268, 40],
                [121, 153, 88],
                [63, 228, 78],
                [250, 256, 13],
                [4, 101, 60],
                [18, 160, 79],
                [245, 247, 11],
                [167, 226, 34],
                [170, 252, 46],
                [20, 137, 15],
                [70, 153, 14],
                [38, 134, 40],
                [48, 113, 74],
                [74, 97, 52],
                [118, 203, 99],
                [47, 86, 12],
                [25, 173, 87],
                [121, 188, 20],
                [11, 69, 11],
                [146, 219, 99],
                [3, 276, 56],
                [139, 202, 98],
                [88, 249, 22],
                [55, 79, 55],
                [46, 195, 62],
                [39, 74, 68],
                [194, 258, 18],
                [55, 98, 34],
                [37, 62, 64],
                [6, 281, 56],
                [33, 130, 63],
                [28, 50, 26],
                [120, 171, 84],
                [43, 172, 90],
                [123, 141, 28],
                [35, 92, 58],
                [56, 76, 23],
                [64, 98, 10],
                [221, 247, 98],
                [147, 241, 90],
                [263, 279, 85],
                [130, 138, 89],
                [127, 147, 23],
                [173, 197, 47],
                [137, 258, 21],
                [138, 177, 20],
                [119, 197, 37],
                [3, 36, 15],
                [71, 264, 55],
                [120, 179, 87],
                [43, 248, 42],
                [95, 251, 64],
                [151, 235, 81],
                [67, 264, 19],
                [92, 182, 87],
                [155, 275, 38],
                [21, 244, 78],
                [205, 253, 57],
                [23, 252, 61],
                [70, 227, 43],
                [36, 226, 11],
                [113, 193, 34],
                [243, 276, 88],
                [71, 156, 36],
                [29, 185, 44],
                [68, 123, 31],
                [115, 261, 59],
                [77, 194, 19],
                [51, 118, 14],
                [109, 145, 65],
                [134, 202, 16],
                [4, 162, 85],
                [79, 123, 75],
                [8, 45, 59],
                [220, 259, 29],
                [57, 272, 76],
                [236, 276, 59],
                [34, 37, 57],
                [58, 278, 86],
                [162, 273, 28],
                [73, 269, 15],
                [258, 272, 80],
                [95, 126, 97],
                [108, 168, 18],
                [31, 94, 84],
                [94, 217, 23],
                [82, 85, 85],
                [1, 197, 75],
                [39, 81, 27],
                [108, 222, 74],
                [39, 247, 34],
                [69, 122, 24],
                [139, 181, 54],
                [9, 138, 39],
                [83, 249, 13],
                [59, 260, 76],
                [187, 207, 37],
                [25, 40, 68],
                [97, 158, 36],
                [121, 157, 86],
                [145, 207, 83],
                [140, 281, 79],
                [8, 160, 30],
                [106, 229, 79],
                [90, 271, 72],
                [159, 201, 36],
                [233, 242, 89],
                [22, 78, 46],
                [82, 126, 80],
                [71, 215, 42],
                [49, 277, 26],
                [233, 246, 28],
                [12, 42, 74],
                [68, 141, 59],
                [32, 181, 49],
                [117, 183, 92],
                [166, 255, 98],
                [232, 279, 70],
                [5, 103, 75],
                [66, 180, 14],
                [10, 84, 77],
                [177, 255, 83],
                [99, 263, 94],
                [21, 176, 55],
                [45, 82, 29],
                [26, 248, 51],
                [103, 228, 61],
                [55, 211, 87],
                [102, 179, 80],
                [14, 49, 10],
                [188, 254, 26],
                [186, 226, 78],
                [0, 136, 32],
                [13, 42, 72],
                [74, 150, 52],
                [174, 196, 94],
                [229, 233, 21],
                [191, 263, 52],
                [32, 257, 71],
                [106, 148, 28],
                [49, 118, 84],
                [174, 268, 28],
                [88, 190, 74],
                [177, 244, 26],
                [158, 196, 38],
                [6, 10, 27],
                [180, 212, 54],
                [186, 200, 93],
                [41, 239, 75],
                [6, 154, 61],
                [30, 52, 42],
                [221, 246, 57],
                [218, 251, 100],
                [220, 237, 54],
                [146, 237, 22],
                [129, 213, 82],
                [190, 227, 50],
                [193, 249, 28],
                [204, 254, 62],
                [212, 255, 25],
                [140, 205, 95],
                [100, 165, 89],
                [222, 268, 15],
                [87, 93, 34],
                [178, 216, 48],
                [28, 108, 94],
                [50, 115, 10],
                [196, 271, 12],
                [13, 40, 60],
                [61, 155, 73],
                [25, 109, 33],
                [77, 181, 11],
                [186, 231, 92],
                [44, 251, 59],
                [30, 61, 39],
                [72, 124, 79],
                [31, 80, 24],
                [125, 148, 32],
                [199, 212, 53],
                [209, 237, 31],
                [146, 217, 17],
                [64, 156, 90],
                [10, 61, 59],
                [211, 257, 36],
                [14, 72, 77],
                [28, 200, 43],
                [30, 127, 24],
                [18, 102, 97],
                [217, 275, 75],
                [230, 245, 48],
                [42, 243, 100],
                [127, 136, 94],
                [34, 207, 10],
                [214, 267, 36],
                [57, 220, 24],
                [89, 246, 25],
                [24, 111, 66],
                [13, 244, 80],
                [245, 271, 21],
                [23, 273, 68],
                [163, 184, 78],
                [60, 216, 30],
                [64, 278, 43],
                [267, 274, 63],
                [78, 136, 29],
                [76, 195, 95],
                [169, 260, 39],
                [154, 270, 19],
                [101, 182, 47],
                [114, 279, 67],
                [122, 160, 93],
                [27, 205, 88],
                [31, 270, 57],
                [75, 129, 20],
                [51, 163, 56],
                [24, 213, 18],
                [167, 201, 69],
                [35, 124, 55],
                [27, 87, 74],
                [9, 154, 15],
                [62, 100, 15],
                [102, 254, 83],
                [169, 183, 15],
                [81, 228, 57],
                [133, 176, 71],
                [116, 156, 70],
                [29, 266, 66],
                [41, 75, 55],
                [109, 240, 69],
                [166, 211, 14],
                [188, 198, 75],
                [114, 187, 11],
                [124, 132, 79],
                [119, 184, 31],
                [87, 213, 79],
                [7, 224, 73],
                [96, 198, 36],
                [84, 176, 76],
                [184, 202, 57],
                [90, 266, 61],
                [63, 210, 84],
                [7, 175, 84],
                [198, 262, 80],
                [167, 204, 55],
                [101, 224, 93],
                [7, 192, 13],
                [152, 231, 85],
                [78, 132, 70],
                [122, 274, 21],
                [46, 133, 60],
                [165, 192, 46],
                [57, 275, 79],
                [192, 225, 83],
                [15, 60, 55],
                [116, 267, 72],
                [114, 231, 64],
                [41, 214, 24],
                [135, 225, 92],
                [219, 273, 99],
                [106, 169, 12],
                [110, 239, 81],
                [161, 183, 19],
                [83, 128, 22],
                [239, 257, 16],
                [96, 165, 58],
                [119, 262, 20],
                [69, 180, 17],
                [29, 129, 70],
                [175, 274, 81],
                [142, 187, 78],
                [91, 230, 33],
                [1, 40, 18],
                [223, 230, 28],
                [85, 223, 62],
                [199, 235, 23],
                [32, 58, 53],
                [46, 209, 30],
                [135, 260, 58],
                [232, 240, 14],
                [15, 152, 20],
                [0, 62, 65],
                [142, 152, 29],
                [80, 161, 48],
                [96, 190, 68],
                [131, 264, 62],
                [91, 161, 66],
                [1, 63, 36],
                [44, 131, 55],
                [100, 224, 23],
                [142, 243, 92],
                [110, 266, 57],
            ],
            95,
        ),
        1_890_593,
    );

    const EXTRA_TEST_CASE_2: TestCase = (
        (
            &[
                7604, 904, 47, 2553, 8851, 1912, 7361, 3518, 6802, 8416, 9276, 2517, 5710, 4404, 8018, 353, 6740, 9918,
                8417, 7677, 3616, 4177, 3424, 5820, 8618, 4059, 1502, 4653, 7885, 7424, 9961, 2827, 3814, 4882, 2808,
            ],
            &[
                [2, 6, 54],
                [4, 30, 18],
                [6, 20, 24],
                [10, 16, 94],
                [25, 30, 94],
                [12, 25, 71],
                [10, 11, 67],
                [8, 24, 93],
                [14, 16, 34],
                [4, 14, 48],
                [23, 26, 66],
                [10, 29, 70],
                [2, 33, 56],
                [15, 25, 96],
                [6, 14, 66],
                [5, 10, 61],
                [6, 12, 33],
                [29, 34, 10],
                [9, 29, 63],
                [17, 19, 81],
                [3, 14, 48],
                [9, 21, 73],
                [13, 30, 54],
                [19, 27, 65],
                [4, 33, 41],
                [29, 31, 35],
                [17, 31, 23],
                [23, 28, 52],
                [0, 17, 44],
                [15, 17, 30],
                [7, 16, 60],
                [2, 3, 90],
                [3, 4, 44],
                [3, 5, 51],
                [9, 28, 95],
                [7, 23, 23],
                [26, 34, 48],
                [5, 33, 47],
                [16, 22, 64],
                [1, 18, 93],
                [21, 31, 31],
                [26, 32, 49],
                [8, 26, 25],
                [18, 24, 73],
                [19, 21, 41],
                [0, 31, 20],
                [7, 30, 38],
                [23, 27, 85],
                [24, 33, 56],
                [11, 25, 90],
                [11, 27, 53],
                [12, 18, 73],
                [21, 24, 38],
                [13, 34, 76],
                [13, 32, 74],
                [7, 27, 36],
                [15, 34, 72],
                [12, 13, 11],
                [20, 22, 48],
                [1, 19, 43],
                [9, 15, 58],
                [11, 32, 18],
                [0, 32, 87],
                [0, 28, 20],
                [2, 18, 53],
                [20, 28, 82],
                [8, 22, 68],
                [5, 22, 27],
                [8, 20, 12],
            ],
            69,
        ),
        15489,
    );

    pub fn run<S: Solution>() {
        let test_cases = [
            (
                (
                    &[0, 32, 10, 43] as &[_],
                    &[[0, 1, 10], [1, 2, 15], [0, 3, 10]] as &[_],
                    49,
                ),
                75,
            ),
            ((&[5, 10, 15, 20], &[[0, 1, 10], [1, 2, 10], [0, 3, 10]], 30), 25),
            (
                (&[1, 2, 3, 4], &[[0, 1, 10], [1, 2, 11], [2, 3, 12], [1, 3, 13]], 50),
                7,
            ),
            ((&[95], &[], 83), 95),
            EXTRA_TEST_CASE_1,
            EXTRA_TEST_CASE_2,
        ];

        for ((values, edges, max_time), expected) in test_cases {
            assert_eq!(
                S::maximal_path_quality(values.to_vec(), edges.iter().map(Vec::from).collect(), max_time),
                expected,
            );
        }
    }
}
